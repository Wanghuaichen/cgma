
# configured file for installing ACIS

SET(ACIS_INSTALL_PREFIX "@ACIS_INSTALL_PREFIX@")
SET(ACIS_SHARED_LIBRARY_DIR "@ACIS_SHARED_LIBRARY_DIR@")
SET(ACIS_SHARED_LIBRARY_DIR_DEBUG "@ACIS_SHARED_LIBRARY_DIR_DEBUG@")
SET(ACIS_INSTALL_LIBS "@ACIS_INSTALL_LIBS@")
SET(ACIS_INSTALL_LIBS_DEBUG "@ACIS_INSTALL_LIBS_DEBUG@")
SET(CMAKE_COMMAND "@CMAKE_COMMAND@")

IF(WIN32)
  IF(BUILD_TYPE MATCHES "Release")
    SET(ACIS_LIBS ${ACIS_INSTALL_LIBS})
    SET(ACIS_LIB_DIR ${ACIS_SHARED_LIBRARY_DIR})
  ELSE(BUILD_TYPE MATCHES "Release")
    SET(ACIS_LIBS ${ACIS_INSTALL_LIBS_DEBUG})
    SET(ACIS_LIB_DIR ${ACIS_SHARED_LIBRARY_DIR_DEBUG})
  ENDIF(BUILD_TYPE MATCHES "Release")
ELSE(WIN32)
  SET(ACIS_LIBS ${ACIS_INSTALL_LIBS})
  SET(ACIS_LIB_DIR ${ACIS_SHARED_LIBRARY_DIR})
ENDIF(WIN32)

MESSAGE(STATUS "Installing ACIS libraries")
FOREACH(ACIS_LIB ${ACIS_LIBS})
  MESSAGE(STATUS "  Installing ${ACIS_LIB}")
  # get .dll, .so, .sl files matching this name
  FILE(GLOB FOUND_LIBS "${ACIS_LIB_DIR}/*${ACIS_LIB}.[ds]*")
  FOREACH(FOUND_LIB ${FOUND_LIBS})
    IF(WIN32)
      # copy the library
      EXEC_PROGRAM(${CMAKE_COMMAND} ARGS -E copy "\"${FOUND_LIB}\"" "\"${ACIS_INSTALL_PREFIX}\"")
    ELSE(WIN32)
      # see if this is a soft link
      EXEC_PROGRAM(ls ARGS -l ${FOUND_LIB} OUTPUT_VARIABLE OUT)
      IF(${OUT} MATCHES " -> ")
        # make a new softlink
        STRING(REGEX MATCH "lib${ACIS_LIB}\\@CMAKE_SHARED_LIBRARY_SUFFIX@[\\.0-9]*$" SOFTLINK ${OUT})
        GET_FILENAME_COMPONENT(LIBNAME ${FOUND_LIB} NAME)
        EXEC_PROGRAM(ln ${ACIS_INSTALL_PREFIX} ARGS -sf ${SOFTLINK} ${LIBNAME} OUTPUT_VARIABLE JUNK)
      ELSE(${OUT} MATCHES " -> ")
        # copy the library
        FILE(INSTALL DESTINATION ${ACIS_INSTALL_PREFIX} TYPE SHARED_LIBRARY
                     FILES ${FOUND_LIB})
      ENDIF(${OUT} MATCHES " -> ")
    ENDIF(WIN32)
  ENDFOREACH(FOUND_LIB)
ENDFOREACH(ACIS_LIB)

